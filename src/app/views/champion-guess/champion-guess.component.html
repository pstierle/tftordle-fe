<div class="flex flex-col gap-5 max-w-xl">
  <div
    class="p-5 rounded flex flex-col gap-3 items-center border-2"
    [style.backgroundColor]="'#1E2328'"
    [style.borderColor]="'#AE9667'"
  >
    <p class="font-semibold text-xl">
      Guess today's Teamfight Tactics champion!
    </p>

    <p class="w-full font-semibold text-center" *ngIf="finished$ | async">
      You Correctly guessed the Champion in {{ guessCount$ | async }} tries!
    </p>
  </div>

  <p *ngIf="errorMessage$ | async" class="text-center text-sm text-red-400">
    {{ errorMessage$ | async }}
  </p>

  <div
    class="relative w-full"
    *ngIf="!(finished$ | async)"
    (clickOutside)="handleClickOutSide()"
  >
    <div class="flex gap-2 items-center">
      <input
        type="text"
        class="px-4 py-2 w-full primary-input"
        [ngModel]="query"
        (ngModelChange)="handleChange($event)"
        (focus)="handleFocus()"
        placeholder="Search for Champions"
      />
      <button
        class="px-4 py-2 font-semibold secondary-input disabled:opacity-50"
        [style.borderColor]="'#AE9667'"
        (click)="guess()"
        [disabled]="selectedChampion === undefined"
      >
        Guess
      </button>
    </div>
    <div
      class="absolute w-full overflow-y-auto z-10"
      [style.backgroundColor]="'#1E2328'"
      *ngIf="showResults"
    >
      <p
        class="w-full text-center font-semibold p-2"
        *ngIf="(results$ | async)?.length === 0; else results"
      >
        No results found
      </p>
      <ng-template #results>
        <div
          *ngFor="let result of results$ | async"
          class="w-full px-4 py-2 hover:cursor-pointer hover:bg-[#22262B] transition-colors flex items-center gap-2"
          (click)="selectGuess(result)"
        >
          <img
            [src]="result.imagePath"
            alt="Logo"
            class="h-8 w-8"
            *ngIf="result.imagePath"
          />
          <p>{{ result.name }} - Set: {{ result.set }}</p>
        </div>
      </ng-template>
    </div>
  </div>

  <div class="flex flex-col gap-2 items-center justify-center">
    <app-guess
      class="w-full"
      *ngFor="let guess of guesses$ | async"
      [champion]="guess"
    ></app-guess>
  </div>
</div>
